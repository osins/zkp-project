# Circom Circuits Module

> **âš ï¸ é‡è¦æ›´æ–° (2025-11-08):**  
> æœ¬æ¨¡å—å·²å®Œæˆé‡å¤§é‡æ„ï¼Œç°åœ¨éµå¾ªä¸¥æ ¼çš„ç”Ÿäº§ç¯å¢ƒç”µè·¯è§„èŒƒã€‚

## ğŸ“‹ ç›®å½•ç»“æ„

```
circom-circuits/
â”œâ”€â”€ circuits/
â”‚   â”œâ”€â”€ production/          # ğŸ”’ ç”Ÿäº§çº§ç”µè·¯ï¼ˆå½“å‰ä¸ºç©ºï¼Œå¾…å®¡æŸ¥åæ·»åŠ ï¼‰
â”‚   â”‚   â””â”€â”€ README.md        # ç”Ÿäº§ç”µè·¯å‡†å…¥è¦æ±‚
â”‚   â”œâ”€â”€ examples/            # ğŸ“š ç¤ºä¾‹å’Œå­¦ä¹ ç”µè·¯
â”‚   â”‚   â”œâ”€â”€ multiplier.circom                      # âœ… å¯ç”¨ç¤ºä¾‹
â”‚   â”‚   â”œâ”€â”€ DEPRECATED_range_proof_broken.circom   # ğŸ”´ å·²åºŸå¼ƒï¼ˆå«ç¼ºé™·ï¼‰
â”‚   â”‚   â”œâ”€â”€ DEPRECATED_hash_verifier_insecure.circom # ğŸ”´ å·²åºŸå¼ƒï¼ˆä¸å®‰å…¨ï¼‰
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â””â”€â”€ tests/               # ğŸ§ª æµ‹è¯•è¾…åŠ©ç”µè·¯
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ CIRCUIT_SPECIFICATION.md   # ç”µè·¯è®¾è®¡è§„èŒƒ
â”‚   â””â”€â”€ REVIEW_CHECKLIST.md        # å®¡æŸ¥æ¸…å•
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ build_example.sh           # æ„å»ºç¤ºä¾‹ç”µè·¯
â”‚   â”œâ”€â”€ lint_all.sh                # è¿è¡Œæ‰€æœ‰æ£€æŸ¥
â”‚   â”œâ”€â”€ lint_hardcoded.sh          # æ£€æŸ¥ç¡¬ç¼–ç å€¼
â”‚   â”œâ”€â”€ lint_documentation.sh      # æ£€æŸ¥æ–‡æ¡£å®Œæ•´æ€§
â”‚   â”œâ”€â”€ lint_deprecated.sh         # æ£€æŸ¥åºŸå¼ƒç”µè·¯
â”‚   â”œâ”€â”€ security_check.sh          # å®‰å…¨æ£€æŸ¥
â”‚   â””â”€â”€ check_constraints.sh       # çº¦æŸå®Œæ•´æ€§æ£€æŸ¥
â”‚
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ test_multiplier.js         # Multiplier ç”µè·¯æµ‹è¯•å¥—ä»¶
â”‚
â”œâ”€â”€ .circomlint.json               # Linter é…ç½®
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ circuit-check.yml      # CI è‡ªåŠ¨æ£€æŸ¥
â”‚
â””â”€â”€ package.json
```

## ğŸ¯ æ ¸å¿ƒåŸåˆ™

### 1. ç”Ÿäº§ç¯å¢ƒä¸ç¤ºä¾‹ä»£ç å®Œå…¨éš”ç¦»

- **ç”Ÿäº§ç”µè·¯** (`circuits/production/`): ç»è¿‡ä¸¥æ ¼å®¡æŸ¥ã€æµ‹è¯•å’ŒéªŒè¯
- **ç¤ºä¾‹ç”µè·¯** (`circuits/examples/`): ç”¨äºå­¦ä¹ ã€æ¼”ç¤ºå’Œæµ‹è¯•
- **ç¦æ­¢**: ç”Ÿäº§ä»£ç å¼•ç”¨ç¤ºä¾‹ç›®å½•ï¼Œç¤ºä¾‹ä»£ç ç›´æ¥åˆå¹¶åˆ°ç”Ÿäº§

### 2. å¼ºåˆ¶ç”µè·¯è®¾è®¡è§„èŒƒ

æ¯ä¸ªç”µè·¯å¿…é¡»åŒ…å«ï¼š
- âœ… å®Œæ•´çš„æ–‡æ¡£å¤´ï¼ˆç”¨é€”ã€çŠ¶æ€ã€è¾“å…¥/è¾“å‡ºã€çº¦æŸè¯´æ˜ï¼‰
- âœ… æ˜ç¡®çš„ä¿¡å·ç±»å‹å£°æ˜ï¼ˆprivate/publicï¼‰
- âœ… å®Œæ•´çš„çº¦æŸå®šä¹‰ï¼ˆæ— çœç•¥ã€æ— ç¡¬ç¼–ç ï¼‰
- âœ… å®‰å…¨å‡è®¾è¯´æ˜

### 3. ä¸¥æ ¼çš„å®¡æŸ¥æµç¨‹

ç”Ÿäº§ç”µè·¯å‡†å…¥è¦æ±‚ï¼š
- âœ… è‡³å°‘ 2 äººä»£ç å®¡æŸ¥
- âœ… æµ‹è¯•è¦†ç›–ç‡ >= 90%
- âœ… CI æ£€æŸ¥å…¨éƒ¨é€šè¿‡
- âœ… å®‰å…¨å®¡æŸ¥é€šè¿‡

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
npm install
```

### æ„å»ºç¤ºä¾‹ç”µè·¯

```bash
# æ„å»º Multiplier ç¤ºä¾‹
npm run build:example multiplier

# æˆ–ä½¿ç”¨å®Œæ•´å‘½ä»¤
bash scripts/build_example.sh multiplier
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
npm run test:example

# å¸¦è¦†ç›–ç‡
npm run test:coverage
```

### è¿è¡Œ Lint æ£€æŸ¥

```bash
# è¿è¡Œæ‰€æœ‰æ£€æŸ¥
npm run lint

# è¿è¡Œç‰¹å®šæ£€æŸ¥
npm run lint:hardcoded    # æ£€æŸ¥ç¡¬ç¼–ç å€¼
npm run lint:docs         # æ£€æŸ¥æ–‡æ¡£
npm run lint:deprecated   # æ£€æŸ¥åºŸå¼ƒç”µè·¯
npm run security          # å®‰å…¨æ£€æŸ¥
npm run check:constraints # çº¦æŸå®Œæ•´æ€§æ£€æŸ¥
```

## ğŸ“š å¯ç”¨ç”µè·¯

### âœ… ç¤ºä¾‹ç”µè·¯

| ç”µè·¯ | æ–‡ä»¶ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|------|
| Multiplier | `examples/multiplier.circom` | âœ… å¯ç”¨ | ç®€å•ä¹˜æ³•éªŒè¯ï¼Œé€»è¾‘æ­£ç¡®ï¼Œå¯ç”¨äºå­¦ä¹  |

### ğŸ”´ å·²åºŸå¼ƒç”µè·¯ï¼ˆå«ä¸¥é‡ç¼ºé™·ï¼‰

| ç”µè·¯ | æ–‡ä»¶ | ç¼ºé™· | é£é™© |
|------|------|------|------|
| RangeProof | `DEPRECATED_range_proof_broken.circom` | ç¡¬ç¼–ç è¾“å‡º `valid <== 1` | ğŸ”´ ä¸¥é‡ - ä»»ä½•è¾“å…¥éƒ½ä¼šé€šè¿‡ |
| HashVerifier | `DEPRECATED_hash_verifier_insecure.circom` | ä½¿ç”¨å¹³æ–¹ä½œä¸ºå“ˆå¸Œ | ğŸ”´ ä¸¥é‡ - å¯é€†ã€ç¢°æ’é£é™© |

**âš ï¸ è­¦å‘Š**: åºŸå¼ƒç”µè·¯å·²è¢«ç¦ç”¨ï¼Œä»…ä¿ç•™ç”¨äºæ•™å­¦ï¼ˆå±•ç¤ºé”™è¯¯æ¨¡å¼ï¼‰ã€‚

## ğŸ”’ ç”Ÿäº§ç”µè·¯ä½¿ç”¨

**å½“å‰çŠ¶æ€**: ç”Ÿäº§ç›®å½•ä¸ºç©ºï¼Œæ‰€æœ‰ç”µè·¯éƒ½åœ¨ç¤ºä¾‹ç›®å½•ä¸­ã€‚

å¦‚éœ€ä½¿ç”¨ç”µè·¯äºç”Ÿäº§ç¯å¢ƒï¼š

1. é˜…è¯» `docs/CIRCUIT_SPECIFICATION.md`
2. å®Œæˆ `docs/REVIEW_CHECKLIST.md` ä¸­çš„æ‰€æœ‰æ£€æŸ¥é¡¹
3. æäº¤ Pull Request
4. ç­‰å¾…è‡³å°‘ 2 åå®¡æŸ¥å‘˜æ‰¹å‡†
5. é€šè¿‡æ‰€æœ‰ CI æ£€æŸ¥

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµ

### æ·»åŠ æ–°ç”µè·¯

1. **åœ¨ç¤ºä¾‹ç›®å½•åˆ›å»ºç”µè·¯**:
   ```bash
   vim circuits/examples/my_circuit.circom
   ```

2. **éµå¾ªæ–‡æ¡£æ¨¡æ¿** (è§ `docs/CIRCUIT_SPECIFICATION.md`)

3. **æ·»åŠ æµ‹è¯•**:
   ```bash
   vim tests/test_my_circuit.js
   ```

4. **æ„å»ºå’Œæµ‹è¯•**:
   ```bash
   npm run build:example my_circuit
   npm test
   ```

5. **è¿è¡Œ lint æ£€æŸ¥**:
   ```bash
   npm run lint
   ```

### æäº¤ç”Ÿäº§ç”µè·¯

1. å®Œæˆå®¡æŸ¥æ¸…å•
2. æäº¤ PR åˆ° `circuits/production/`
3. ç­‰å¾…å®¡æŸ¥
4. åˆå¹¶åéƒ¨ç½²

## ğŸ“– æ–‡æ¡£

- [ç”µè·¯è®¾è®¡è§„èŒƒ](docs/CIRCUIT_SPECIFICATION.md)
- [å®¡æŸ¥æ¸…å•](docs/REVIEW_CHECKLIST.md)
- [ç”Ÿäº§ç”µè·¯è¦æ±‚](circuits/production/README.md)
- [ç¤ºä¾‹ç”µè·¯è¯´æ˜](circuits/examples/README.md)

## ğŸ” CI/CD è‡ªåŠ¨æ£€æŸ¥

æ¯æ¬¡æäº¤éƒ½ä¼šè‡ªåŠ¨è¿è¡Œï¼š

1. **Lint æ£€æŸ¥**
   - ç¡¬ç¼–ç å€¼æ£€æµ‹
   - æ–‡æ¡£å®Œæ•´æ€§
   - åºŸå¼ƒç”µè·¯æ£€æµ‹

2. **ç¼–è¯‘æ£€æŸ¥**
   - æ‰€æœ‰ç”µè·¯ç¼–è¯‘æ— é”™è¯¯
   - æ— ç¼–è¯‘è­¦å‘Š

3. **æµ‹è¯•æ£€æŸ¥**
   - æ‰€æœ‰æµ‹è¯•é€šè¿‡
   - è¦†ç›–ç‡è¾¾æ ‡

4. **å®‰å…¨æ£€æŸ¥**
   - ä¸å®‰å…¨æ¨¡å¼æ£€æµ‹
   - çº¦æŸå®Œæ•´æ€§éªŒè¯

è¯¦è§ `.github/workflows/circuit-check.yml`

## ğŸš¨ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆ RangeProof å’Œ HashVerifier è¢«åºŸå¼ƒï¼Ÿ

**A**: è¿™äº›ç”µè·¯å­˜åœ¨ä¸¥é‡çš„å®‰å…¨ç¼ºé™·ï¼š
- **RangeProof**: ç¡¬ç¼–ç è¾“å‡º `valid <== 1`ï¼Œæ— è®ºè¾“å…¥å¦‚ä½•éƒ½ä¼šé€šè¿‡
- **HashVerifier**: ä½¿ç”¨å¹³æ–¹ä½œä¸ºå“ˆå¸Œå‡½æ•°ï¼Œä¸å®‰å…¨ï¼ˆå¯é€†ã€ç¢°æ’ï¼‰

å®ƒä»¬è¢«ä¿ç•™ä»…ç”¨äºæ•™å­¦ç›®çš„ï¼ˆå±•ç¤ºé”™è¯¯æ¨¡å¼ï¼‰ã€‚

### Q: å¯ä»¥ç›´æ¥ä½¿ç”¨ç¤ºä¾‹ç”µè·¯äºç”Ÿäº§å—ï¼Ÿ

**A**: âŒ **ä¸å¯ä»¥**ã€‚ç¤ºä¾‹ç”µè·¯æœªç»è¿‡ç”Ÿäº§çº§å®¡æŸ¥ã€‚å¦‚éœ€ç”¨äºç”Ÿäº§ï¼š
1. å®Œæˆå®Œæ•´çš„å®‰å…¨å®¡æŸ¥
2. è¡¥å……å®Œæ•´æµ‹è¯•ï¼ˆè¦†ç›–ç‡ >= 90%ï¼‰
3. é€šè¿‡ä»£ç å®¡æŸ¥æµç¨‹
4. ç¬¦åˆ `circuits/production/README.md` ä¸­çš„æ‰€æœ‰è¦æ±‚

### Q: å¦‚ä½•è¿è¡Œ Multiplier ç¤ºä¾‹ï¼Ÿ

**A**:
```bash
# 1. æ„å»ºç”µè·¯
npm run build:example multiplier

# 2. è¿è¡Œæµ‹è¯•
npm run test:example

# 3. æŸ¥çœ‹è¾“å‡º
ls -la build/
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ï¼è¯·éµå¾ªï¼š

1. é˜…è¯» `docs/CIRCUIT_SPECIFICATION.md`
2. åœ¨ `circuits/examples/` ä¸­å¼€å‘
3. æ·»åŠ å®Œæ•´æµ‹è¯•
4. è¿è¡Œ `npm run lint`
5. æäº¤ PR

## ğŸ“„ æ›´æ–°æ—¥å¿—

### v2.0.0 (2025-11-08) - é‡å¤§é‡æ„

**é‡å¤§å˜æ›´**:
- âœ… é‡æ„ç›®å½•ç»“æ„ï¼šç”Ÿäº§/ç¤ºä¾‹/æµ‹è¯•åˆ†ç¦»
- âœ… åºŸå¼ƒæœ‰ç¼ºé™·çš„ç”µè·¯ï¼ˆRangeProofã€HashVerifierï¼‰
- âœ… å»ºç«‹å®Œæ•´çš„å®¡æŸ¥æµç¨‹
- âœ… æ·»åŠ  CI/CD è‡ªåŠ¨æ£€æŸ¥
- âœ… è¡¥å……å®Œæ•´æ–‡æ¡£å’Œæµ‹è¯•

**ç ´åæ€§å˜æ›´**:
- æ—§çš„ `circuits/example.circom` å·²æ‹†åˆ†åˆ° `circuits/examples/` ç›®å½•
- æ„å»ºè„šæœ¬æ›´æ”¹ä¸º `build:example`

**è¿ç§»æŒ‡å—**:
```bash
# æ—§å‘½ä»¤
npm run build

# æ–°å‘½ä»¤
npm run build:example multiplier
```

### v1.0.0 (ä¹‹å‰)

- åˆå§‹ç‰ˆæœ¬ï¼ˆåŒ…å«æœªåˆ†ç±»çš„ç¤ºä¾‹ç”µè·¯ï¼‰

## ğŸ“ æ”¯æŒ

- æäº¤ Issue: [GitHub Issues](https://github.com/yourusername/zkp-project/issues)
- æŸ¥é˜…æ–‡æ¡£: `docs/` ç›®å½•
- Circom å®˜æ–¹æ–‡æ¡£: https://docs.circom.io/

---

**ç»´æŠ¤è€…**: ZKP Project Team  
**æœ€åæ›´æ–°**: 2025-11-08  
**è®¸å¯è¯**: MIT
